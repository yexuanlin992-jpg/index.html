<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Game Balapan Fisika Sederhana</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #222; display: flex; justify-content: center; align-items: center; height: 100vh; font-family: sans-serif; }
        canvas { border: 2px solid #fff; background-color: #444; }
        #info { position: absolute; top: 10px; left: 10px; color: white; background: rgba(0, 0, 0, 0.5); padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>

    <canvas id="raceCanvas" width="800" height="600"></canvas>

    <div id="info">
        <h3>Kontrol:</h3>
        <p>⬆️: Akselerasi</p>
        <p>⬇️: Rem/Mundur</p>
        <p>⬅️/➡️: Belok</p>
        <p>Kecepatan: <span id="speedDisplay">0.00</span></p>
    </div>

    <script>
        // Mendapatkan elemen Canvas
        const canvas = document.getElementById('raceCanvas');
        const ctx = canvas.getContext('2d');
        const speedDisplay = document.getElementById('speedDisplay');

        // --- Variabel Game dan Fisika ---
        const car = {
            x: 100,
            y: 100,
            width: 20,
            height: 40,
            angle: 0,
            speed: 0,
            maxSpeed: 5,
            acceleration: 0.1,
            friction: 0.05,
            turnSpeed: 0.03
        };

        const keys = {
            up: false,
            down: false,
            left: false,
            right: false
        };

        // --- Fungsi untuk Menggambar Mobil ---
        function drawCar() {
            ctx.save();
            // Pindahkan dan putar konteks gambar ke posisi mobil
            ctx.translate(car.x, car.y);
            ctx.rotate(car.angle);

            // Badan Mobil
            ctx.fillStyle = 'red';
            ctx.fillRect(-car.width / 2, -car.height / 2, car.width, car.height);
            
            // Atap Mobil (ilustrasi)
            ctx.fillStyle = 'black';
            ctx.fillRect(-car.width / 3, -car.height / 4, car.width / 1.5, car.height / 4);

            ctx.restore();
        }

        // --- Fungsi untuk Menggambar Trek (Jalur Sederhana) ---
        function drawTrack() {
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 50;
            ctx.lineCap = 'round';
            ctx.beginPath();
            
            // Contoh jalur sederhana (kotak dengan sudut melengkung)
            ctx.moveTo(100, 100);
            ctx.lineTo(canvas.width - 100, 100);
            ctx.lineTo(canvas.width - 100, canvas.height - 100);
            ctx.lineTo(100, canvas.height - 100);
            ctx.closePath();
            ctx.stroke();

            // Garis Start/Finish
            ctx.strokeStyle = 'yellow';
            ctx.lineWidth = 5;
            ctx.beginPath();
            ctx.moveTo(100, 75);
            ctx.lineTo(100, 125);
            ctx.stroke();
        }

        // --- Fungsi Pembaruan Fisika Mobil ---
        function updateCar() {
            // 1. Input dan Akselerasi
            if (keys.up) {
                car.speed += car.acceleration;
            }
            if (keys.down) {
                // Rem lebih kuat saat speed positif
                if (car.speed > 0) {
                    car.speed -= car.acceleration * 1.5;
                } else {
                    // Mundur
                    car.speed -= car.acceleration / 2;
                }
            }

            // Batasi Kecepatan Maksimal
            car.speed = Math.max(-car.maxSpeed / 2, Math.min(car.maxSpeed, car.speed));

            // 2. Gesekan (Friction)
            if (!keys.up && !keys.down) {
                // Kurangi kecepatan perlahan jika tidak ada input
                if (car.speed > 0) {
                    car.speed -= car.friction;
                    car.speed = Math.max(0, car.speed); // Pastikan tidak negatif
                } else if (car.speed < 0) {
                    car.speed += car.friction;
                    car.speed = Math.min(0, car.speed); // Pastikan tidak positif
                }
            }

            // 3. Belok (Hanya saat bergerak)
            if (Math.abs(car.speed) > 0.1) {
                if (keys.left) {
                    car.angle -= car.turnSpeed * Math.sign(car.speed);
                }
                if (keys.right) {
                    car.angle += car.turnSpeed * Math.sign(car.speed);
                }
            }

            // 4. Update Posisi
            car.x += Math.sin(car.angle) * car.speed;
            car.y -= Math.cos(car.angle) * car.speed;
        }

        // --- Fungsi Utama Loop Game ---
        function gameLoop() {
            // 1. Bersihkan Canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // 2. Gambar Trek
            drawTrack();

            // 3. Perbarui Fisika Mobil
            updateCar();

            // 4. Gambar Mobil
            drawCar();

            // 5. Update Info Display
            speedDisplay.textContent = car.speed.toFixed(2);

            // Lanjutkan Loop
            requestAnimationFrame(gameLoop);
        }

        // --- Event Listener untuk Input Keyboard ---
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowUp') keys.up = true;
            if (e.key === 'ArrowDown') keys.down = true;
            if (e.key === 'ArrowLeft') keys.left = true;
            if (e.key === 'ArrowRight') keys.right = true;
        });

        document.addEventListener('keyup', (e) => {
            if (e.key === 'ArrowUp') keys.up = false;
            if (e.key === 'ArrowDown') keys.down = false;
            if (e.key === 'ArrowLeft') keys.left = false;
            if (e.key === 'ArrowRight') keys.right = false;
        });

        // Mulai Game
        gameLoop();
    </script>
</body>
</html>
